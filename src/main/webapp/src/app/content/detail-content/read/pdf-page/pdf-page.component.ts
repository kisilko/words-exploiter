import { Component, OnInit, Input, ViewChild, ElementRef, OnChanges } from '@angular/core';
import { PDFPageProxy, PDFPageViewport, PDFRenderTask } from 'pdfjs-dist';

@Component({
  selector: 'app-pdf-page',
  templateUrl: './pdf-page.component.html',
  styleUrls: ['./pdf-page.component.scss']
})
export class PdfPageComponent implements OnInit, OnChanges {

  @Input() pdfPage: PDFPageProxy;

  @ViewChild('canvasWrapper') canvasWrapperRef: ElementRef;

  @ViewChild('pdfCanvas') pdfCanvas: ElementRef;

  //canvasContext: CanvasRenderingContext2D;

  constructor() { }

  ngOnInit() {

  }

  ngOnChanges() {
    const canvas = this.pdfCanvas.nativeElement as HTMLCanvasElement;

    const viewport = this.pdfPage.getViewport(1.5) as PDFPageViewport;
    console.log(viewport);
    const context = canvas.getContext('2d') as CanvasRenderingContext2D;
    canvas.height = viewport.height;
    canvas.width = viewport.width;

    const renderContext = {
      canvasContext: context,
      viewport: viewport
    };

    let renderTask: PDFRenderTask = this.pdfPage.render(renderContext);
  }

}
