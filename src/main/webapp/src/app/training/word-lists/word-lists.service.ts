import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { WordList } from '../training.interface';
import { map } from 'rxjs/operators';

@Injectable({
  providedIn: 'root'
})
export class WordListsService {

  constructor(private http: HttpClient) {}

  getWordLists() {
    return this.http.get<Array<string>>('/api/training/get-word-lists');
  }

  getImportedWordList(name: string) {
    const headers: HttpHeaders = new HttpHeaders();
    headers.append('Accept', '*/*');

    return this.http.get<WordList>('/api/training/get-imported-word-list/' + name, { headers: headers } ).pipe(
      map(importedWordList => {
        if (typeof importedWordList.words === 'string') {
          importedWordList.words = JSON.parse(importedWordList.words);
        }
        if (typeof importedWordList.wordsToTrain === 'string') {
          importedWordList.wordsToTrain = JSON.parse(importedWordList.wordsToTrain);
        }
        
        return importedWordList;
      })
    );
  }

  getImportedWordLists() {
    return this.http.get<Array<WordList>>('/api/training/get-imported-word-lists');
  }

  import(listName: string) {
    return this.http.post('/api/training/import-list/', listName).subscribe();
  }
}
