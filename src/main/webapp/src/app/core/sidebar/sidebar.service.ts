import { Injectable } from '@angular/core';
import { ReplaySubject } from 'rxjs';
import * as lodash from 'lodash';
import { NavTab } from '../core.interface';

@Injectable({
  providedIn: 'root'
})
export class SidebarService {

  public static readonly TRAINING = 'training';
  public static readonly CONTENT = 'content';

  private genericTabsSource = new ReplaySubject<Map<string, Array<NavTab>>>(1);

  genericTabs$ = this.genericTabsSource.asObservable();

  genericTabs: Map<string, Array<NavTab>> = new Map(); //new Array<NavTab>();

  constructor() { 
    this.genericTabs.set(SidebarService.TRAINING, new Array());
    this.genericTabs.set(SidebarService.CONTENT, new Array());
  }

  addGenericTab(namespace: string, tab: NavTab) {
    if (!lodash.find(this.genericTabs.get(namespace), tab)) {
      this.genericTabs.get(namespace).push(tab);
      this.genericTabsSource.next(this.genericTabs);
    }
  }

  removeGenericTab(namespace: string, tab: NavTab) {
    if (lodash.find(this.genericTabs.get(namespace), tab)) {
      lodash.remove(this.genericTabs.get(namespace), tab);
      this.genericTabsSource.next(this.genericTabs);
    }
  }
}
